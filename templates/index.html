{% extends "base.html" %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <title>charting python</title>
</head>
<body>
    <div class="col=8 offset-2 my-5">
        <div class="card">
            <div class="container-fluid">
                <canvas id="myChart"></canvas>
                <form method="GET">
                    <div class="date_query">
                        <input type="date" name="begin" format= 'dd/mm/yyyy' startDate= '-3d'>
                        <input type="submit" value="To Date" >
                    </div>
                </form>
                    
                <!--
                <input oninput="updateChart(this)" type="range" id="points" value="2" min="1" max="3">
                {% for prod in products %}
                    <div class="form-check form-switch form-check-inline">
                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault">
                        <label class="form-check-label" for="flexSwitchCheckDefault">{{prod.name}}</label>
                    </div>
                {% endfor %}
                -->

            </div>
        </div>
    </div>

    <script>
    const all_data = {{all_data|safe}};

    //const df3 = {{df3|safe}};
    const df_labels = {{df_labels|safe}};
    const labels = {{labels|safe}};
    const values = {{values|safe}};
    const other_model = {};
    for (let i = 0; i < values.length; i++) {
        other_model[labels[i]] = values[i];
        }
    console.log(other_model);
    window.onload=function(){/* ww w  .  j a  va  2s.co m*/
    var ctx = document.getElementById("myChart");
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: df_labels,
            datasets: []
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true,
                        callback: function(value, index, values) {
                            if (parseInt(value) >= 1000) {
                                return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            } else {
                                return value;
                            }
                        }
                    }
                }]
            }
        }
    });
    var model = other_model;
    for (year in model) {
    var newDataset = {
        label: year,
            data: []
        };
        for (value in model[year]) {
        newDataset.data.push(model[year][value]);
        }
        myChart.config.data.datasets.push(newDataset);
    }
        myChart.update();
        }
    </script>
    
</body>
</html>

{% endblock %}